spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/${DB_NAME:documind_db}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: validate # 스키마 자동 변경 방지
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

  data:
    redis:
      host: ${REDIS_HOST:redis}
      port: ${REDIS_PORT:6379}

  # Ollama 자동 구성 비활성화 (운영 환경에서 미사용)
  autoconfigure:
    exclude:
      - org.springframework.ai.model.ollama.autoconfigure.OllamaApiAutoConfiguration
      - org.springframework.ai.model.ollama.autoconfigure.OllamaChatAutoConfiguration
      - org.springframework.ai.model.ollama.autoconfigure.OllamaEmbeddingAutoConfiguration

  ai:
    model:
      embedding: openai

    # OpenAI API
    openai:
      api-key: ${OPENAI_API_KEY}
      embedding:
        options:
          model: text-embedding-3-large
          dimensions: 1536 # 3072 → 1536 차원 축소 (HNSW 인덱스 최대 2000)

    vectorstore:
      pgvector:
        initialize-schema: false # 운영 환경에서는 수동 스키마 관리
        dimensions: 1536 # 임베딩 벡터 차원 (text-embedding-3-large 축소)

management:
  endpoints:
    web:
      exposure:
        include: "*"
  metrics:
    export:
      influx:
        enabled: ${INFLUX_ENABLED:true}
        uri: http://${INFLUX_HOST:influxdb}:${INFLUX_PORT:8086}
        db: ${INFLUX_DB:k6}

app:
  upload:
    dir: /app/local-storage # 컨테이너 환경 절대 경로

  chat:
    default-model: gpt-4.1-mini # 기본 선택 모델 (alias)
    models:
      - provider: openai
        model-id: gpt-4.1-nano
        alias: gpt-4.1-nano
        display-name: GPT-4.1 Nano
      - provider: openai
        model-id: gpt-4.1-mini
        alias: gpt-4.1-mini
        display-name: GPT-4.1 Mini
      - provider: openai
        model-id: gpt-5-nano
        alias: gpt-5-nano
        display-name: GPT-5 Nano
        reasoning: true
      - provider: openai
        model-id: gpt-5-mini
        alias: gpt-5-mini
        display-name: GPT-5 Mini
        reasoning: true
      - provider: google-genai
        model-id: gemini-2.5-flash
        alias: gemini-2.5-flash
        display-name: Gemini 2.5 Flash
      - provider: google-genai
        model-id: gemini-2.5-flash-lite
        alias: gemini-2.5-flash-lite
        display-name: Gemini 2.5 Flash-Lite

logging:
  level:
    org.springframework.ai.chat.client.advisor: info
